<div class="card">
    <input type="hidden" id="post-id" value="{{userPostData.id}}">
    <div class="card-header">
        <h5>{{userPostData.title}}</h5>
        <p>Posted by {{userPostData.user.username}} on {{userPostData.date}}</p>
    </div>
    <div class="card-body">
        <p>{{userPostData.content}}</p>
    </div>
</div>

{{#each userPostData.comments as |comment|}}
<div class="card">
    {{!-- <input type="hidden" id="comment-id" value="{{userPostData.id}}"> --}}
    <div class="card-header">
        {{!-- <h5>{{userPostData.comments.title}}</h5> --}}
    </div>
    <div class="card-body">
        <p>{{comment.content}}</p>
        <p>- {{comment.user.username}} on {{comment.date}}</p>
    </div>
</div>
{{/each}}


<div class="card">
    {{!-- <input type="hidden" id="comment-id" value="{{userPostData.id}}"> --}}
    <div class="card-header">
        {{!-- <h5>{{userPostData.comments.title}}</h5> --}}
    </div>
    <div class="card-body">
        <div class="form-new-comment">
            <form>
                <div class="mb-3">
                    <label for="exampleFormControlTextarea1" class="form-label">Comment</label>
                    <textarea class="form-control" id="comment-content" rows="3"></textarea>
                </div>

                <div class="d-grid gap-2">
                    <button class="btn btn-lg btn-outline" id="new-comment-btn" type="submit">Submit</button>
                </div>
            </form>
        </div>
    </div>
</div>

<script>
    console.log('Hello World');

const newCommentFormHandler = async (event) => {
    event.preventDefault();

    const content = document.querySelector('#comment-content').value.trim();
    const id = document.querySelector('#post-id').value;

    if (content) {

        const response = await fetch('/api/comments/', {
            method: 'POST',
            body: JSON.stringify({ content, id }),
            headers: { 'Content-Type': 'application/json' },
        });

        if (response.ok) {
            document.location.reload();
        } else {
            alert(response.statusText);
        }
    }
};

document
    .querySelector('.form-new-comment')
    .addEventListener('submit', newCommentFormHandler);
</script>

{{!-- <script src="./js/comment.js"></script> --}}